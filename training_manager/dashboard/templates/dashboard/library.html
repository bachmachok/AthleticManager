{% extends "dashboard/base.html" %}

{% block title %}–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ ‚Äî Athletic Manager{% endblock %}

{% block content %}
  <h1 class="text-2xl md:text-3xl font-semibold tracking-tight mb-6">üé• –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –≤—ñ–¥–µ–æ</h1>

  <!-- –§—ñ–ª—å—Ç—Ä -->
  <article class="card mb-8">
    <form method="get" class="card-body grid grid-cols-1 md:grid-cols-[auto,1fr,auto] gap-4 md:items-center">
      <label for="event" class="text-sm font-medium text-gray-700 dark:text-gray-200">
        –§—ñ–ª—å—Ç—Ä –∑–∞ —Ç–∏–ø–æ–º –ø–æ–¥—ñ—ó:
      </label>

      <div>
        <select
          name="event"
          id="event"
          class="w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm
                 focus:outline-none focus:ring-2 focus:ring-brand-500
                 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100">
          <option value="">–£—Å—ñ</option>
          <option value="RUNNING"  {% if filter_event == 'RUNNING' %}selected{% endif %}>–ë—ñ–≥</option>
          <option value="JUMPING"  {% if filter_event == 'JUMPING' %}selected{% endif %}>–°—Ç—Ä–∏–±–∫–∏</option>
          <option value="THROWING" {% if filter_event == 'THROWING' %}selected{% endif %}>–ú–µ—Ç–∞–Ω–Ω—è/–®—Ç–æ–≤—Ö–∞–Ω–Ω—è</option>
        </select>
      </div>

      <div class="flex md:justify-end">
        <button type="submit" class="btn btn-primary">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
      </div>
    </form>
  </article>

  <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó -->
  {% if categories %}
    <div class="space-y-8">
      {% for cat in categories %}
        {% with videos=cat.videos.all %}
          {% if videos|length %}
            <article class="card">
              <header class="card-body pb-4 border-b border-gray-200 dark:border-white/10">
                <div class="flex flex-wrap items-center gap-3 justify-between">
                  <h2 class="text-lg font-semibold">
                    {{ cat.get_attempt_type_display }}
                  </h2>
                  <div class="flex flex-wrap items-center gap-2 text-xs">
                    <span class="inline-flex items-center rounded-full bg-gray-200 px-2.5 py-1 font-medium text-gray-800 dark:bg-white/10 dark:text-gray-200">
                      üìç {{ cat.place }}
                    </span>
                    <span class="inline-flex items-center rounded-full bg-gray-200 px-2.5 py-1 font-medium text-gray-800 dark:bg_white/10 dark:text-gray-200">
                      üìÖ {{ cat.date }}
                    </span>
                  </div>
                </div>
              </header>

              <div class="card-body">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  {% for video in videos %}
                    <article class="card overflow-hidden">
                      <div class="card-body pb-0">
                        <ul class="text-sm space-y-1">
                          <li><span class="text-gray-500 dark:text-gray-400">üè∑Ô∏è –¢–∏–ø:</span> {{ video.get_event_type_display }}</li>
                          <li><span class="text-gray-500 dark:text-gray-400">üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:</span> {{ video.result }}</li>
                          <li><span class="text-gray-500 dark:text-gray-400">üßÆ –°–ø—Ä–æ–±–∞ ‚Ññ:</span> {{ video.attempt_number }}</li>
                          <li><span class="text-gray-500 dark:text-gray-400">‚è±Ô∏è –ß–∞—Å:</span> {{ video.time }}</li>
                        </ul>
                      </div>
                      <div class="p-4 pt-3">
                        <video controls class="w-full rounded-lg ring-1 ring-gray-200 dark:ring-white/10">
                          <source src="{{ video.video.url }}" type="video/mp4">
                        </video>
                      </div>
                    </article>
                  {% endfor %}
                </div>
              </div>
            </article>
          {% endif %}
        {% endwith %}
      {% endfor %}
    </div>
  {% else %}
    <article class="card">
      <div class="card-body">
        <p class="text-gray-600 dark:text-gray-300 italic">–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –∞–±–æ –≤—ñ–¥–µ–æ.</p>
      </div>
    </article>
  {% endif %}
{% endblock %}
